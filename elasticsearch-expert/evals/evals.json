{
  "skill_name": "elasticsearch-expert",
  "evals": [
    {
      "id": 1,
      "prompt": "Design an index mapping for an e-commerce product catalog with name, description, price, categories, and attributes that vary per product.",
      "expected_output": "A mapping using text with keyword sub-field for name, text for description, scaled_float for price, keyword for categories, and flattened type for dynamic attributes. Should include a custom analyzer consideration for the name field.",
      "files": [],
      "assertions": [
        "Uses text type with keyword sub-field for product name",
        "Uses scaled_float or appropriate numeric for price",
        "Recommends flattened or dynamic_templates for variable attributes",
        "Does not use nested unless justified"
      ]
    },
    {
      "id": 2,
      "prompt": "My Elasticsearch query is slow. It uses from: 50000, size: 10 to paginate through results. How can I fix this?",
      "expected_output": "Recommends replacing from/size with search_after and point-in-time (PIT) for deep pagination. Explains why from/size is expensive at high offsets and provides a complete search_after example.",
      "files": [],
      "assertions": [
        "Identifies from/size as the performance problem",
        "Recommends search_after with PIT",
        "Provides a working JSON example",
        "Mentions _shard_doc as tiebreaker sort"
      ]
    },
    {
      "id": 3,
      "prompt": "I have 500 GB of logs per day. How should I size my Elasticsearch cluster?",
      "expected_output": "Calculates shard count (500/40 ~= 13 primary shards), recommends data tiers with ILM, estimates storage with replicas and overhead, advises on node sizing including heap and filesystem cache.",
      "files": [],
      "assertions": [
        "Calculates primary shards based on 10-50 GB target",
        "Accounts for replicas in total storage",
        "Recommends ILM with hot/warm/cold tiers",
        "Mentions heap sizing rules (50% RAM, max 31 GB)",
        "Asks about or mentions retention requirements"
      ]
    },
    {
      "id": 4,
      "prompt": "I want to add semantic search to my existing Elasticsearch text search. What are my options?",
      "expected_output": "Presents options: dense_vector with external embeddings, ELSER for out-of-box semantic search, semantic_text field type for simplicity. Recommends hybrid search with RRF to combine lexical and semantic results.",
      "files": [],
      "assertions": [
        "Mentions dense_vector with kNN",
        "Mentions ELSER as an option",
        "Recommends hybrid search approach",
        "Explains RRF or linear combination for merging results",
        "Asks about Elasticsearch version"
      ]
    },
    {
      "id": 5,
      "prompt": "Write an ES|QL query to find the top 10 services by error count in the last hour from a logs index.",
      "expected_output": "A correct ES|QL query using FROM, WHERE with timestamp filter and log level filter, STATS with COUNT, and SORT with LIMIT.",
      "files": [],
      "assertions": [
        "Uses FROM logs-* or similar pattern",
        "Filters by @timestamp >= NOW() - 1 hour",
        "Filters by error log level",
        "Uses STATS with COUNT grouped BY service",
        "Uses SORT DESC and LIMIT 10"
      ]
    },
    {
      "id": 6,
      "prompt": "My cluster has 500 unassigned shards. How do I diagnose and fix this?",
      "expected_output": "Recommends using _cluster/allocation/explain API, lists common causes (disk watermark, shard limits, node filters), provides remediation steps for each cause.",
      "files": [],
      "assertions": [
        "Uses _cluster/allocation/explain API",
        "Mentions disk watermark as a common cause",
        "Mentions node filter or awareness rules",
        "Provides actionable remediation steps"
      ]
    },
    {
      "id": 7,
      "prompt": "I'm using Elastic Cloud Serverless. Can I configure ILM policies and check cluster health?",
      "expected_output": "Explains that ILM APIs and _cluster/health are not available in serverless. Recommends built-in data retention policies instead of ILM, and _cat/indices or _search as alternatives for health monitoring.",
      "files": [],
      "assertions": [
        "States that _cluster/health is unavailable in serverless",
        "States that ILM APIs are unavailable in serverless",
        "Recommends data retention policies as alternative",
        "Mentions _cat/indices or _search as serverless-compatible alternatives"
      ]
    },
    {
      "id": 8,
      "prompt": "I want to build a hybrid search that combines BM25 text search with vector similarity and then re-ranks using a cross-encoder model. I'm on Elasticsearch 9.2.",
      "expected_output": "Recommends composing retrievers: use RRF or linear retriever to combine standard and knn retrievers, then wrap with text_similarity_reranker retriever pointing to an inference endpoint.",
      "files": [],
      "assertions": [
        "Uses the Retrievers API (not manual script_score combination)",
        "Combines standard and knn retrievers via rrf or linear",
        "Uses text_similarity_reranker for re-ranking",
        "Mentions inference_id for the reranker model",
        "Provides a complete nested retriever JSON example"
      ]
    },
    {
      "id": 9,
      "prompt": "We're ingesting 200GB of logs per day into Elasticsearch 9.x. What index mode should we use and how can we optimize storage?",
      "expected_output": "Recommends LogsDB index mode (default in 9.x for logs-*-*), explains synthetic _source and automatic index sorting benefits, suggests pattern_text for message fields (9.3+), recommends ILM with hot/warm/cold/frozen tiers.",
      "files": [],
      "assertions": [
        "Recommends LogsDB index mode",
        "Explains synthetic _source for storage reduction",
        "Mentions pattern_text field type for message fields",
        "Mentions up to 4x storage reduction with LogsDB",
        "Recommends ILM or data retention policies"
      ]
    },
    {
      "id": 10,
      "prompt": "We're upgrading from Elasticsearch 8.16 to 9.0. What are the key breaking changes and migration steps?",
      "expected_output": "States that 8.19 is required as a stepping stone before 9.0. Lists key breaking changes: Enterprise Search removal, AWS SDK v2 in repository-s3, ELSER inference service deprecation, LogsDB enabled by default. Recommends running the Upgrade Assistant.",
      "files": [],
      "assertions": [
        "Requires upgrading to 8.19 first",
        "Mentions Enterprise Search removal",
        "Mentions ELSER inference service deprecation",
        "Mentions LogsDB enabled by default for logs-*-*",
        "Recommends using the Upgrade Assistant"
      ]
    }
  ]
}
